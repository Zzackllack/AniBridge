version: "3.8"
services:
  anibridge:
    image: ghcr.io/zzackllack/anibridge:latest
    container_name: anibridge
    ports:
      - "8000:8000"
    environment:
      - LOG_LEVEL=${LOG_LEVEL:-INFO}
      - DOWNLOAD_DIR=${DOWNLOAD_DIR:-/data/downloads/anime}
      - DATA_DIR=${DATA_DIR:-/data}
      - QBIT_PUBLIC_SAVE_PATH=${QBIT_PUBLIC_SAVE_PATH}
      - ANIWORLD_ALPHABET_HTML=${ANIWORLD_ALPHABET_HTML}
      - ANIWORLD_ALPHABET_URL=${ANIWORLD_ALPHABET_URL:-https://aniworld.to/animes-alphabet}
      - ANIWORLD_TITLES_REFRESH_HOURS=${ANIWORLD_TITLES_REFRESH_HOURS:-24}
      - SOURCE_TAG=${SOURCE_TAG:-WEB}
      - RELEASE_GROUP=${RELEASE_GROUP:-aniworld}
      - PROVIDER_ORDER=${PROVIDER_ORDER:-VOE,Filemoon,Streamtape,Vidmoly,SpeedFiles,Doodstream,LoadX,Luluvdo,Vidoza}
      - MAX_CONCURRENCY=${MAX_CONCURRENCY:-3}
      - INDEXER_NAME=${INDEXER_NAME:-AniBridge Torznab}
      - INDEXER_API_KEY=${INDEXER_API_KEY}
      - TORZNAB_CAT_ANIME=${TORZNAB_CAT_ANIME:-5070}
      - AVAILABILITY_TTL_HOURS=${AVAILABILITY_TTL_HOURS:-24}
      - TORZNAB_FAKE_SEEDERS=${TORZNAB_FAKE_SEEDERS:-999}
      - TORZNAB_FAKE_LEECHERS=${TORZNAB_FAKE_LEECHERS:-787}
      - TORZNAB_RETURN_TEST_RESULT=${TORZNAB_RETURN_TEST_RESULT:-true}
      - TORZNAB_TEST_TITLE=${TORZNAB_TEST_TITLE:-AniBridge Connectivity Test}
      - TORZNAB_TEST_SLUG=${TORZNAB_TEST_SLUG:-connectivity-test}
      - TORZNAB_TEST_SEASON=${TORZNAB_TEST_SEASON:-1}
      - TORZNAB_TEST_EPISODE=${TORZNAB_TEST_EPISODE:-1}
      - TORZNAB_TEST_LANGUAGE=${TORZNAB_TEST_LANGUAGE:-German Dub}
      - PYTHONUNBUFFERED=1
    volumes:
      - ./data:/data
    healthcheck:
      test:
        ["CMD", "curl", "--fail", "--silent", "http://localhost:8000/health"]
      interval: 30s
      timeout: 5s
      retries: 3
