################################################################################
# AniBridge — Example Environment (.env)
# Copy this file to `.env` and adjust values to your environment.
################################################################################

## ——— Logging ————————————————————————————————————————————————
# What: Global log level
# Default: INFO
# Recommended: DEBUG/TRACE while integrating; INFO in production
LOG_LEVEL=INFO


## ——— Paths & Storage ————————————————————————————————————————
# What: Where AniBridge writes completed downloads
# Default: On host → ./data/downloads/anime (resolved absolute at runtime)
# Recommended (Docker): Volume-mount this into Sonarr/Radarr (e.g. /downloads)
DOWNLOAD_DIR=./data/downloads/anime

# What: General app data (DB, caches, logs)
# Default: ./data (resolved absolute at runtime)
DATA_DIR=./data

# What: Public save path to publish via qBittorrent shim (path Sonarr sees)
# Default: empty (falls back to DOWNLOAD_DIR)
# Recommended (Docker): Set to the container-visible mount (e.g. /downloads)
QBIT_PUBLIC_SAVE_PATH=


## ——— Catalogue Sites ————————————————————————————————————————
# What: Comma-separated catalogue list to enable. `aniworld.to` = anime, `s.to`/`serienstream.to` = general TV series, `megakino` = movies/series
# Default: aniworld.to,s.to,megakino
CATALOG_SITES=aniworld.to,s.to,megakino

## AniWorld Catalogue
# What: Base URL for AniWorld (override when mirrors/domains change)
# Default: https://aniworld.to
ANIWORLD_BASE_URL=https://aniworld.to

# What: Local HTML snapshot used to build AniWorld slug/title index
# Default: ./data/aniworld-alphabeth.html
ANIWORLD_ALPHABET_HTML=./data/aniworld-alphabeth.html

# What: Live AniWorld alphabet page (used when local is missing/stale)
# Default: https://aniworld.to/animes-alphabet
ANIWORLD_ALPHABET_URL=https://aniworld.to/animes-alphabet

# What: Refresh interval (hours) for AniWorld title index
# Default: 24 (0 = never refresh during process lifetime)
ANIWORLD_TITLES_REFRESH_HOURS=24

## Serienstream / S.to Catalogue
# What: Base URL for Serienstream (s.to) catalogue
# Default: https://s.to
STO_BASE_URL=https://s.to

# What: Local HTML snapshot for Serienstream titles
# Default: ./data/sto-alphabeth.html
STO_ALPHABET_HTML=./data/sto-alphabeth.html

# What: Live Serienstream alphabet page
# Default: https://s.to/serien-alphabet
STO_ALPHABET_URL=https://s.to/serien-alphabet

# What: Refresh interval (hours) for Serienstream title index
# Default: 24 (0 = never refresh during process lifetime)
STO_TITLES_REFRESH_HOURS=24

## Megakino Catalogue (search-only)
# What: Base URL for megakino (auto-resolved at startup; override if needed)
# Default: https://megakino1.to
MEGAKINO_BASE_URL=https://megakino1.to

# What: Refresh interval (hours) for the megakino sitemap index
# Default: 12
MEGAKINO_TITLES_REFRESH_HOURS=12

# What: Domain check interval in minutes (0 disables background checks)
# Default: 100
MEGAKINO_DOMAIN_CHECK_INTERVAL_MIN=100


## ——— Release Naming —————————————————————————————————————————
# What: Source tag embedded in release names
# Default: WEB (e.g. 1080p.WEB.H264)
SOURCE_TAG=WEB

# What: Release group suffix (after hyphen)
# Default: aniworld (becomes -ANIWORLD)
RELEASE_GROUP=aniworld

# Optional: Override release group per catalogue (falls back to RELEASE_GROUP)
# Default: RELEASE_GROUP for AniWorld, "sto" for Serienstream
RELEASE_GROUP_ANIWORLD=aniworld
RELEASE_GROUP_STO=serienstream


## ——— Provider Fallback —————————————————————————————————————
# What: Preferred provider order (left→right) for direct URL resolution
# Default: VOE,Filemoon,Streamtape,Vidmoly,SpeedFiles,Doodstream,LoadX,Luluvdo,Vidoza
PROVIDER_ORDER=VOE,Filemoon,Streamtape,Vidmoly,SpeedFiles,Doodstream,LoadX,Luluvdo,Vidoza


## ——— Concurrency ———————————————————————————————————————————
# What: Parallel downloads (ThreadPoolExecutor workers)
# Default: 3 (min 1)
MAX_CONCURRENCY=3


## ——— Torznab / Indexer ————————————————————————————————————
# What: Name shown for the indexer
# Default: AniBridge Torznab
INDEXER_NAME=AniBridge Torznab

# What: Optional API key. When set, requests to /torznab/api must include ?apikey=
# Default: empty (no auth)
INDEXER_API_KEY=

# What: Anime category (Torznab/Newznab)
# Default: 5070
TORZNAB_CAT_ANIME=5070

# What: Movie category (Torznab/Newznab)
# Default: 2000
TORZNAB_CAT_MOVIE=2000


## ——— Availability Cache ————————————————————————————————————
# What: TTL (hours) for cached availability/quality per episode/lang
# Default: 24
AVAILABILITY_TTL_HOURS=24


## ——— Torznab Fake Seeders/Leechers (cosmetic) —————————————
# What: Cosmetic seed/leech counts to satisfy some indexer clients
# Default: 999 / 787
TORZNAB_FAKE_SEEDERS=999
TORZNAB_FAKE_LEECHERS=787


## ——— Torznab Test Result (Connectivity) ————————————————
# What: Return a synthetic item for t=search with no query
# Default: true
# Recommended: true (prowlarr will use this to verify connectivity and will report the indexer as offline if set to false)
TORZNAB_RETURN_TEST_RESULT=true

# What: Fields for the synthetic test item
TORZNAB_TEST_TITLE=AniBridge Connectivity Test
TORZNAB_TEST_SLUG=connectivity-test
TORZNAB_TEST_SEASON=1
TORZNAB_TEST_EPISODE=1
TORZNAB_TEST_LANGUAGE=German Dub


## ——— STRM Files ———————————————————————————————————————————
# What: Emit `.strm` variants in Torznab and create `.strm` files instead of downloading media.
# Values:
#  - no   (default): behave like today (download via yt-dlp)
#  - both: expose both variants for each release (download + STRM)
#  - only: expose only STRM variants
#
# Notes:
#  - STRM files are plain text with a single HTTP(S) URL line.
#  - AniBridge currently writes the resolved direct provider URL into the .strm.
STRM_FILES_MODE=no


## ——— Cleanup —————————————————————————————————————————————
# What: Remove source file when Sonarr/Radarr tells the client to delete the torrent
# How: On /api/v2/torrents/delete, if deleteFiles=true OR this flag is true, AniBridge deletes the file
# Default: true (delete files after import); set to false to keep source files
# Recommended: true
DELETE_FILES_ON_TORRENT_DELETE=true

# What: Time-to-live for completed files in DOWNLOAD_DIR (auto-cleanup)
# How: Background thread scans DOWNLOAD_DIR and deletes video files older than this TTL
# Default: 0 (disabled). Set to e.g. 12 or 24 to enable periodic cleanup
# Recommended: 12 or 24
DOWNLOADS_TTL_HOURS=0

# What: Scan interval (minutes) for TTL cleanup
# Default: 30
# Recommended: 30
CLEANUP_SCAN_INTERVAL_MIN=30


## ——— Progress Rendering ———————————————————————————————————
# What: Force rendering a live progress bar even if stdout is not a TTY (e.g., uvicorn reload pipes)
# Default: false (auto-detect TTY). Set to true to force bar; otherwise you’ll get 5% log updates
PROGRESS_FORCE_BAR=false

# What: Percentage step for non-TTY progress log updates
# Default: 5
PROGRESS_STEP_PERCENT=5


## ——— Update Notifier ————————————————————————————————————————
# What: Check for new releases at startup and log the status
# Default: true
# Recommended: true
ANIBRIDGE_UPDATE_CHECK=true

# Optional: GitHub token to raise API rate limits (no scopes needed)
# ANIBRIDGE_GITHUB_TOKEN=

# Optional: Override sources (defaults are for official builds)
# ANIBRIDGE_GITHUB_OWNER=zzackllack
# ANIBRIDGE_GITHUB_REPO=AniBridge
# ANIBRIDGE_GHCR_IMAGE=zzackllack/anibridge

## ——— Development ————————————————————————————————————————————
# What: Enable auto-reload of code on changes (development only)
# Default: false (disabled in packaged/production runs)
# Recommended: false (production); true (development)
ANIBRIDGE_RELOAD=false

# What: Bind host/port for the HTTP server
# Default: 0.0.0.0:8000
# Note: When sharing a VPN network namespace (e.g., network_mode: service:gluetun),
# ensure each service uses a unique internal port and expose it via the VPN container.
ANIBRIDGE_HOST=0.0.0.0
ANIBRIDGE_PORT=8000

# What: CORS origins for the HTTP API (comma-separated; * = all)
# Default: * (allow all origins)
# Values:
#  - *: allow all origins (default)
#  - http://localhost:5173,http://127.0.0.1:5173: allow only specific origins
#  - off / none: disable CORS middleware entirely
ANIBRIDGE_CORS_ORIGINS=*

## ——— Diagnostics / Public IP ————————————————————————————————
# What: Periodically log the public IP even when proxy is disabled (useful behind VPN/Gluetun)
# Default: false
PUBLIC_IP_CHECK_ENABLED=false

# What: Interval (minutes) for public IP checks when enabled
# Default: inherits PROXY_IP_CHECK_INTERVAL_MIN (30)
PUBLIC_IP_CHECK_INTERVAL_MIN=30


## ——— Networking / Proxy ——————————————————————————————————————
# WARNING: Proxy support is experimental and may be unreliable with some
# providers/CDNs. For production use, prefer a full VPN tunnel at the
# system/container level (e.g., run AniBridge behind Gluetun in Docker).
# Do not rely on the in‑app proxy alone for consistent operation.
#
# What: Route all outbound HTTP/HTTPS requests and downloads via a proxy
# How: Supports http(s) and SOCKS (use socks5h for remote DNS)
# Default: false (disabled)
PROXY_ENABLED=false

# What: Common proxy URL used for all protocols unless overridden
# Examples: http://127.0.0.1:8080  |  socks5://127.0.0.1:1080  |  socks5h://user:pass@host:1080
# Default: empty
PROXY_URL=

# What: Per-protocol overrides (take precedence over PROXY_URL when set)
# Default: empty (falls back to PROXY_URL)
HTTP_PROXY_URL=
HTTPS_PROXY_URL=
ALL_PROXY_URL=

# What: Split proxy settings (used to build PROXY_URL when it is empty)
# Default: PROXY_SCHEME=socks5, others empty
PROXY_HOST=
PROXY_PORT=
PROXY_SCHEME=socks5

# What: Credentials for proxy auth (applied to PROXY_URL/overrides if missing)
# Default: empty
PROXY_USERNAME=
PROXY_PASSWORD=

# What: Comma-separated hosts to bypass proxy (e.g., localhost,127.0.0.1)
# Default: empty
NO_PROXY=

# What: Use remote DNS resolution for SOCKS5 (socks5h) to avoid DNS leaks
# Recommended: true
# Default: false
PROXY_FORCE_REMOTE_DNS=false
# Note: When enabled (or when scope affects downloads), AniBridge upgrades
# socks5:// to socks5h:// for better compatibility.

# What: Disable TLS certificate verification for requests (corporate proxies)
# Default: false (verify certs)
PROXY_DISABLE_CERT_VERIFY=false

# What: Apply proxy to process environment (HTTP(S)_PROXY/NO_PROXY) for 3rd-party libs
# Default: true
PROXY_APPLY_ENV=true

# What: Periodically log the current public IP when proxy is enabled (minutes)
# Default: 30 (set 0 to disable)
PROXY_IP_CHECK_INTERVAL_MIN=30

# What: Limit where proxy is applied: all|requests|ytdlp (experimental)
# - all: proxy both HTTP clients and yt-dlp (default)
# - requests: proxy only HTTP clients, direct yt-dlp
# - ytdlp: proxy only yt-dlp, direct HTTP clients (use if providers block VPN)
PROXY_SCOPE=all
